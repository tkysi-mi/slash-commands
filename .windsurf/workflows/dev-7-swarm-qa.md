# /dev-7-swarm-qa

## 目的

- 実装フェーズで生成されたPR/Storyを対象に、マルチエージェントでの品質保証とセキュリティチェックを自動化・体系化する。
- Claude-FlowのスウォームアーキテクチャとAwesome Claude Codeで蓄積されたベストプラクティスを統合し、レビュー工程を高速化する。

## 前提

- `/dev-5-implementation`でStoryファイルとPRが準備され、テストログ・変更概要が整っている。
- QAポリシー、セキュリティ基準、リリース条件がREADMEやRulesに明記されている。
- スウォーム構成に利用するMCPツール・Claude Skillsへのアクセス権限が有効化されている。
- 必要なメタデータをWindsurfの`code_search`/`read_file`/`grep_search`で取得でき、CIログなどが欠落している場合は`update_plan`で補完タスクを管理できる。
- 後続のリリース/運用ワークフローが存在しない場合でも、手順5に従い手動でリリース可否を判断できる。

## 手順

### プラン作成（Create Plans）

1. インテークとゴール確認

   - Storyファイルから目的・変更範囲・完了条件・既知課題を読み取り、レビュー対象のゴールを明確にする。
   - PRのdiff、テスト結果、CIステータスを`code_search`/`read_file`/`grep_search`で取得し、欠落があればDev担当へ補足を依頼する。
   - 情報が不足している場合は`update_plan`でTODO化し、ステークホルダーへ早期に確認を依頼する。

2. QAポリシーと成功条件の整合

   - チームのQA基準、セキュリティポリシー、リリース条件を読み込み、Storyに参照リンクを追加する。
   - リスクログや非機能要件を確認し、検証すべき観点を優先度付きでリスト化する。

### システム設計（System Design）

1. スウォームチーム設計

   - Claude-FlowのQueen/Worker構成を想定し、以下の役割を割り当てる（重複兼任可）。
     - **Static Checker**: Lint/Static Analysis結果の確認と警告の優先度付け。
     - **Test Verifier**: テストカバレッジや追加テスト案の検討。
     - **Security Auditor**: セキュリティ・コンプライアンス観点のチェック。
     - **Doc Reviewer**: ドキュメント整合性と変更履歴の追跡。
   - 必要なSkillsやMCPツール（例: `security-scan`, `unit-test-runner`, `doc-diff`）を有効化し、アクセス権限を確認する。

2. チェックリストと基準値の定義

   - 各役割が検証すべき項目と評価基準（重大度、ブロッキング条件）を明文化し、Storyに貼付する。
   - 長時間化が予想されるレビューは`update_plan`でサブタスク化し、担当者・期限・完了条件を設定する。

### タスク実行（Task Execution）

1. レビュー実施

   - 「FOR EACH 役割」について、指定領域のdiffやテストログを分析し、問題点・改善案・確認済み項目を箇条書きで記録する。
   - 重大度（Critical/High/Medium/Low）と対応優先度（Blocking/Non-blocking）を付与し、StoryとPRにコメントを残す。
   - 自動化ツールで検出した結果は人間が再確認し、誤検出を除外する。

2. フィードバック統合と再検証

   - 修正が必要な場合は`Call /dev-5-implementation`を指示し、追跡用チェックリストをStoryに追加する。
   - 修正後は差分テストや再スキャンを実施し、結果をStoryとPRに更新する。

3. リリース前評価とハンドオーバー

   - 重大なBlocking項目が解消されているか最終確認する。
   - セキュリティ・性能・ユーザー影響に関する承認が必要な場合は、ガバナンス担当やプロダクトオーナーへレビューを依頼する。
   - リリース判定やデプロイワークフロー（例: `/release-candidate`）へ進む条件を明記する。後続ワークフローが無い場合は、リリース可否の最終判断と手動デプロイ手順をStoryに記載する。

## 完了条件

- レビュー結果がStoryファイルとPRに記録され、重大な問題が解決またはエスカレーション済みである。
- 必要なテスト・スキャンが実施され、エビデンスが揃っている。
- 次に実行すべきワークフロー（リリース、運用監視など）が特定され、担当者が合意している。

## エスカレーション

- 高リスクの脆弱性・データ損失・法的リスクが判明した場合は、セキュリティチームや法務担当へ即時エスカレーションする。
- スウォーム構成やMCPツールで実現困難な検証が必要な場合は、人間の専門家に代替手段を依頼する。
