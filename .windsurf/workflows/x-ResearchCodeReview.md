---
description: 公式ドキュメントと公認サンプルを調査してから実装を検証するリサーチ駆動型コードレビューワークフロー
auto_execution_mode: 1
---

# /research-code-review

## 目的

- 変更対象のライブラリやフレームワークについて公式情報・公認サンプルを収集し、正しい実装手順を明確化する。
- 既存コードと変更内容をリサーチ結果と照合し、欠落・誤り・ベストプラクティス逸脱を検出する。
- 必要な修正案と検証手順を提示し、信頼性の高いコードレビュー結果を提供する。

## 前提

- 対象リポジトリの最新ブランチを取得済みで、差分確認ツール（`git diff` 等）が利用できる。
- 公式ドキュメント／ベンダーブログ／公認サンプルリポジトリへアクセスでき、ライセンス上の制約がない。
- `fetch` MCP や `search_web` MCP、必要に応じて `sequential-thinking` MCP が許可されている。
- DeepWiki MCP や Context7 MCP を利用する場合は、組織のナレッジベースとの連携ポリシーを確認しておく。
- 静的解析ツールやテストスイート（`run_command` 経由）が実行できる環境が整っている。
- 機密コードを外部に送信できない場合は、外部リサーチ時にコンテキストを要約するなど情報保護ポリシーを遵守する。

## 手順

1. **変更差分と要求の把握**

   - 依頼メッセージ・仕様書・チケットを確認し、期待挙動と制約を要約する。
   - `git diff` やレビュー UI で変更ファイルと重要な関数／コンポーネントを特定する。

2. **リサーチ計画の立案**

   - 変更で利用する主要ライブラリ・API・設計パターンを列挙し、リサーチ優先度（必須／確認／参考）を決める。
   - 公式ドキュメント、リリースノート、公認サンプルリポジトリ、信頼できるベストプラクティス記事を候補として洗い出す。

3. **情報収集（一次ソース優先）**

   - `fetch` や `search_web` MCP で公式ドキュメントを取得し、該当 API／コンポーネントの推奨実装・制約・注意点をメモする。
   - DeepWiki MCP や Context7 MCP で社内Wikiや関連知識ベースを照会し、既存実績や組織独自のベストプラクティスを確認する。
   - ベンダーやメンテナが公開しているサンプルリポジトリを確認し、同様のユースケースのコード断片を収集する。
   - 必要に応じて `sequential-thinking` MCP で観点を再整理し、調査漏れがないかチェックする。

4. **ベストプラクティスチェックリストの作成**

   - 収集した知見から「必須要件」「推奨パターン」「避けるべきアンチパターン」を箇条書きで整理する。
   - バージョン依存や互換性注意事項がある場合はバージョン番号とともに記録する。

5. **実装の照合**

   - 変更コードと既存コードをチェックリストと比較し、未遵守項目や差分を洗い出す。
   - 公式サンプルとの差分がある場合は理由を推測し、必要なら開発者へ確認すべき論点としてメモする。
   - スタティックリソース（型定義、設定ファイル）も対象に含め、依存関係や設定値がベストプラクティス通りか確認する。

6. **実行検証**

   - `run_command` で静的解析（Ruff、ESLint 等）やテスト（`npm test`、`pytest` など）を実行し、リサーチ結果と矛盾する警告・失敗がないか確認する。
   - Web UI や API の挙動を確認する必要があれば Playwright MCP や Chrome DevTools MCP で再現テスト・ログ取得を行う。

7. **レビュー結果の整理**

   - リサーチに基づく遵守状況、検出した問題、推奨修正案、追加で確認すべき質問事項をまとめる。
   - 修正提案には参照元（公式ドキュメント URL、サンプルファイルパス等）を添付し、根拠を明確にする。

8. **フォローアップと共有**

   - レビューコメントやレポート形式に落とし込み、開発者へ共有する。
   - 未解決の質問や追加検証が必要な項目を TODO として記録し、回答期限とオーナーを設定する。

## 完了条件

- 公式情報に基づくチェックリストと比較結果が整理され、根拠付きでレビューコメントを提示できている。
- 必要な修正案・テスト結果・未解決事項が明文化され、関係者と共有済みである。
- リサーチで得た参考リンクやサンプルが記録され、再利用可能な知見として残っている。

## エスカレーション

- 公式情報が見つからず実装方針を確定できない場合は、ライブラリメンテナ／プロダクトオーナーへ確認を依頼する。
- ライセンスやセキュリティ上の懸念がある実装が見つかった場合は、セキュリティチームや法務担当へ速やかに報告する。
- 大規模な設計変更が必要と判断した場合は、アーキテクトやリードエンジニアとレビュー会議を設定する。
