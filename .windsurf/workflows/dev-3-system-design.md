# /dev-3-system-design

## 目的

- 合意済みの要求を基に、PRD/アーキテクチャ/リスクログを整備する。
- 役割間のバトンパスやStory入力フォーマットを策定し、実装フェーズに渡せる設計成果物を揃える。

## 前提

- `/dev-1-plan-intake`が完了し、ゴール・制約・優先度が明文化されている。
- Windsurfの`code_search`/`read_file`で既存設計や依存モジュールの情報を取得できる。
- 設計レビューが可能なステークホルダー（Architect、PM、QA）がアクセスできる。

## 手順

1. テンプレート準備

   - BMad Methodの役割分担を参考に、以下のテンプレート/ドキュメントを整備する。既存が無い場合は`Call /create-workflow`で作成する。
     - **PRD**（課題、ユーザーストーリー、非機能要件、受入基準）
     - **アーキテクチャ設計**（構成図、依存モジュール、データ契約、影響範囲）
     - **リスクログ**（制約、技術的懸念、回避策）

2. コンテキスト整理

   - 長文資料は`@docs/...`形式で参照し、PRD/設計書には要約を記載する。
   - Claude-Flowのハイブリッドメモリを意識し、重要キーワードや識別子にラベルを付与する。

3. 役割連携とStoryフォーマット

   - Analyst → PM → Architect → QA/Scrum Masterのバトンパスを定義し、期待するアウトプットを明記する。
   - Story/タスクへ渡す必須フィールド（目的、依存、テスト観点、エラーハンドリング方針、MCPツール）を整理する。

4. 設計レビュー

   - 主要ステークホルダーとレビューを行い、設計・リスク・テスト観点について承認を得る。
   - フィードバックはPRD/設計書/リスクログに反映し、変更履歴を残す。

## 完了条件

- PRD、アーキテクチャ設計、リスクログが最新化され、レビュー済みである。
- Story/タスクに必要な入力フォーマットが確定し、実装チームが利用できる状態で保存されている。

## エスカレーション

- アーキテクチャ方針に重大な争点がある場合は、アーキテクトまたは技術委員会に判断を委ねる。
- 非機能要件やリスクが受容できない場合は、プロダクトオーナーへ再調整を依頼する。
